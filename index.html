<!doctype html>
<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>
<script src="http://code.jquery.com/jquery-1.11.1.js"></script>
<style>
	#messageArea {
		list-style: none;
		display: block;
		overflow: scroll;
		height: 600px;
	}
	.nameTag {
		color: Blue;
		font-size: small;
	}
	.messageTag {
		color: Black;
	}
	.timeTag {
		color: Green;
		font-size: small;
	}
</style>
<script>
var socket = io();

function send(){
	var text = $('#chatText').val();
	var user = $('#userName').val();
	if (text.length == 0) return false;
	socket.emit('chat message', 
		{
			'user': user,
			'text': text
		}
	);
	$('#chatText').val('');
	return false;
}

socket.on('broadcast message', function(msg) {
	var nameTag = $('<li class="nameTag" style="display:none">').text(msg.user + "");
	var msgTag = $('<li class="messageTag" style="display:none">').text(msg.text);
	$('#messageArea').append(nameTag);
	$('#messageArea').append(msgTag);
	nameTag.fadeIn(200);
	msgTag.fadeIn(200);
});

socket.on('enter room', function(msgPack) {
	$(msgPack).each(function(index,value) {
		$('#messageArea').append($('<li class="nameTag">').text(value.user + ""));
		$('#messageArea').append($('<li class="timeTag">').text(value.createTime + ""));		
		$('#messageArea').append($('<li class="messageTag">').text(value.content + ""));		
	});
});

</script>
<head>
	<title>Web Chat</title>
	<h1>Web Chat</h1>
</head>
<body>
	<ul id='messageArea'>
		
	</ul>
	<div>
		<label for='userName'>Name: </label>
		<input id='userName' type='text'/>
		<label for='chatText'>Text: </label>
		<input id='chatText' type='text'/>
		<input id='sendButton' type='button' value='Send' onclick='send()'/>
	</div>
</body>